---
title: "Webhook Events"
description: "Complete reference for all webhook event types and their payloads"
---

# Webhook Events

Detailed reference for all webhook events sent by 1Sub.

## Event Structure

All webhook events follow this structure:

```json
{
  "id": "evt_abc123def456",
  "type": "subscription.activated",
  "created": 1700000000,
  "data": {
    // Event-specific data
  }
}
```

## subscription.activated

Sent when a new subscription is created or a canceled subscription is reactivated.

### When Sent

- User completes initial subscription payment
- User reactivates a previously canceled subscription
- Free trial begins
- Subscription moves from `incomplete` to `active` or `trialing`

### Payload

<ResponseField name="id" type="string" required>
Unique event ID (format: `evt_xxxxx`)
</ResponseField>

<ResponseField name="type" type="string" required>
Always `"subscription.activated"`
</ResponseField>

<ResponseField name="created" type="number" required>
Unix timestamp when event was created
</ResponseField>

<ResponseField name="data" type="object" required>
Event data

<Expandable title="Data Fields">
  <ResponseField name="oneSubUserId" type="string (UUID)" required>
  The 1Sub user ID
  </ResponseField>
  
  <ResponseField name="planId" type="string" required>
  Plan identifier (e.g., `"monthly"`, `"annual"`, `"pro"`)
  </ResponseField>
  
  <ResponseField name="productId" type="string (UUID)" required>
  Your tool's product ID
  </ResponseField>
  
  <ResponseField name="status" type="string" required>
  Subscription status: `"active"` or `"trialing"`
  </ResponseField>
  
  <ResponseField name="currentPeriodStart" type="string (ISO 8601)" required>
  Start of current billing period
  </ResponseField>
  
  <ResponseField name="currentPeriodEnd" type="string (ISO 8601)" required>
  End of current billing period (renewal date)
  </ResponseField>
  
  <ResponseField name="quantity" type="number">
  Subscription quantity (usually 1)
  </ResponseField>
  
  <ResponseField name="creditsRemaining" type="number">
  Credits remaining if subscription includes credits
  </ResponseField>
  
  <ResponseField name="trialEndsAt" type="string (ISO 8601) | null">
  When trial ends, if applicable
  </ResponseField>
</Expandable>
</ResponseField>

### Example Payload

<CodeGroup>
```json New Paid Subscription
{
  "id": "evt_sub_activated_001",
  "type": "subscription.activated",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "550e8400-e29b-41d4-a716-446655440000",
    "planId": "monthly",
    "productId": "660e8400-e29b-41d4-a716-446655440000",
    "status": "active",
    "currentPeriodStart": "2025-11-01T00:00:00Z",
    "currentPeriodEnd": "2025-12-01T00:00:00Z",
    "quantity": 1,
    "creditsRemaining": 1000,
    "trialEndsAt": null
  }
}
```

```json Free Trial Started
{
  "id": "evt_sub_activated_002",
  "type": "subscription.activated",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "550e8400-e29b-41d4-a716-446655440000",
    "planId": "pro",
    "productId": "660e8400-e29b-41d4-a716-446655440000",
    "status": "trialing",
    "currentPeriodStart": "2025-11-01T00:00:00Z",
    "currentPeriodEnd": "2025-12-01T00:00:00Z",
    "quantity": 1,
    "trialEndsAt": "2025-11-08T00:00:00Z"
  }
}
```
</CodeGroup>

### How to Handle

```typescript
case 'subscription.activated':
  const { oneSubUserId, planId, status } = event.data;
  
  // Grant user access
  await grantUserAccess(oneSubUserId, planId);
  
  // Send welcome email
  if (status === 'trialing') {
    await sendTrialStartedEmail(oneSubUserId);
  } else {
    await sendWelcomeEmail(oneSubUserId);
  }
  
  // Clear subscription cache
  subscriptionCache.delete(oneSubUserId);
  
  // Log event
  logger.info('Subscription activated', {
    userId: oneSubUserId,
    plan: planId,
    status
  });
  break;
```

---

## subscription.updated

Sent when subscription details change.

### When Sent

- User upgrades or downgrades plan
- Billing period renews
- Trial ends and converts to paid
- Payment method updated
- Subscription quantity changes

### Payload

<ResponseField name="id" type="string" required>
Unique event ID
</ResponseField>

<ResponseField name="type" type="string" required>
Always `"subscription.updated"`
</ResponseField>

<ResponseField name="created" type="number" required>
Unix timestamp
</ResponseField>

<ResponseField name="data" type="object" required>
Event data

<Expandable title="Data Fields">
  <ResponseField name="oneSubUserId" type="string (UUID)" required>
  The 1Sub user ID
  </ResponseField>
  
  <ResponseField name="planId" type="string" required>
  Current plan ID
  </ResponseField>
  
  <ResponseField name="previousPlanId" type="string">
  Previous plan ID (for plan changes)
  </ResponseField>
  
  <ResponseField name="status" type="string" required>
  Current subscription status
  </ResponseField>
  
  <ResponseField name="previousStatus" type="string">
  Previous subscription status
  </ResponseField>
  
  <ResponseField name="currentPeriodStart" type="string (ISO 8601)" required>
  Start of current billing period
  </ResponseField>
  
  <ResponseField name="currentPeriodEnd" type="string (ISO 8601)" required>
  End of current billing period
  </ResponseField>
  
  <ResponseField name="quantity" type="number">
  Current quantity
  </ResponseField>
  
  <ResponseField name="previousQuantity" type="number">
  Previous quantity (for quantity changes)
  </ResponseField>
</Expandable>
</ResponseField>

### Example Payload

<CodeGroup>
```json Plan Upgrade
{
  "id": "evt_sub_updated_001",
  "type": "subscription.updated",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "550e8400-e29b-41d4-a716-446655440000",
    "planId": "enterprise",
    "previousPlanId": "pro",
    "productId": "660e8400-e29b-41d4-a716-446655440000",
    "status": "active",
    "previousStatus": "active",
    "currentPeriodStart": "2025-11-01T00:00:00Z",
    "currentPeriodEnd": "2025-12-01T00:00:00Z",
    "quantity": 1
  }
}
```

```json Trial Converted
{
  "id": "evt_sub_updated_002",
  "type": "subscription.updated",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "550e8400-e29b-41d4-a716-446655440000",
    "planId": "pro",
    "productId": "660e8400-e29b-41d4-a716-446655440000",
    "status": "active",
    "previousStatus": "trialing",
    "currentPeriodStart": "2025-11-08T00:00:00Z",
    "currentPeriodEnd": "2025-12-08T00:00:00Z",
    "quantity": 1
  }
}
```

```json Billing Period Renewed
{
  "id": "evt_sub_updated_003",
  "type": "subscription.updated",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "550e8400-e29b-41d4-a716-446655440000",
    "planId": "monthly",
    "productId": "660e8400-e29b-41d4-a716-446655440000",
    "status": "active",
    "currentPeriodStart": "2025-12-01T00:00:00Z",
    "currentPeriodEnd": "2026-01-01T00:00:00Z",
    "quantity": 1,
    "creditsRemaining": 1000
  }
}
```
</CodeGroup>

### How to Handle

```typescript
case 'subscription.updated':
  const { oneSubUserId, planId, previousPlanId, status, previousStatus } = event.data;
  
  // Handle plan changes
  if (previousPlanId && previousPlanId !== planId) {
    await updateUserPlan(oneSubUserId, planId, previousPlanId);
    await sendPlanChangeEmail(oneSubUserId, planId, previousPlanId);
  }
  
  // Handle status changes
  if (previousStatus === 'trialing' && status === 'active') {
    await sendTrialConvertedEmail(oneSubUserId);
  }
  
  // Handle renewals (period changed but same plan)
  if (!previousPlanId && status === 'active') {
    await logRenewal(oneSubUserId);
  }
  
  // Clear subscription cache
  subscriptionCache.delete(oneSubUserId);
  break;
```

---

## subscription.canceled

Sent when a subscription is canceled or expires.

### When Sent

- User cancels subscription
- Payment fails after all retry attempts
- Trial expires without payment
- Subscription reaches `cancelAtPeriodEnd` date

### Payload

<ResponseField name="id" type="string" required>
Unique event ID
</ResponseField>

<ResponseField name="type" type="string" required>
Always `"subscription.canceled"`
</ResponseField>

<ResponseField name="created" type="number" required>
Unix timestamp
</ResponseField>

<ResponseField name="data" type="object" required>
Event data

<Expandable title="Data Fields">
  <ResponseField name="oneSubUserId" type="string (UUID)" required>
  The 1Sub user ID
  </ResponseField>
  
  <ResponseField name="planId" type="string" required>
  Plan that was canceled
  </ResponseField>
  
  <ResponseField name="productId" type="string (UUID)" required>
  Your tool's product ID
  </ResponseField>
  
  <ResponseField name="status" type="string" required>
  Always `"canceled"`
  </ResponseField>
  
  <ResponseField name="cancellationReason" type="string">
  Reason for cancellation: `"user_requested"`, `"payment_failed"`, `"trial_expired"`
  </ResponseField>
  
  <ResponseField name="effectiveDate" type="string (ISO 8601)" required>
  When cancellation becomes effective (may be in future if `cancelAtPeriodEnd`)
  </ResponseField>
  
  <ResponseField name="canceledAt" type="string (ISO 8601)" required>
  When cancellation was initiated
  </ResponseField>
</Expandable>
</ResponseField>

### Example Payload

<CodeGroup>
```json User Canceled
{
  "id": "evt_sub_canceled_001",
  "type": "subscription.canceled",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "550e8400-e29b-41d4-a716-446655440000",
    "planId": "pro",
    "productId": "660e8400-e29b-41d4-a716-446655440000",
    "status": "canceled",
    "cancellationReason": "user_requested",
    "effectiveDate": "2025-12-01T00:00:00Z",
    "canceledAt": "2025-11-15T10:30:00Z"
  }
}
```

```json Payment Failed
{
  "id": "evt_sub_canceled_002",
  "type": "subscription.canceled",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "550e8400-e29b-41d4-a716-446655440000",
    "planId": "monthly",
    "productId": "660e8400-e29b-41d4-a716-446655440000",
    "status": "canceled",
    "cancellationReason": "payment_failed",
    "effectiveDate": "2025-11-20T00:00:00Z",
    "canceledAt": "2025-11-20T00:00:00Z"
  }
}
```
</CodeGroup>

### How to Handle

```typescript
case 'subscription.canceled':
  const { oneSubUserId, planId, cancellationReason, effectiveDate } = event.data;
  
  // Check if effective immediately or at period end
  const now = new Date();
  const effective = new Date(effectiveDate);
  
  if (effective <= now) {
    // Revoke access immediately
    await revokeUserAccess(oneSubUserId);
  } else {
    // Schedule revocation for later
    await scheduleAccessRevocation(oneSubUserId, effective);
  }
  
  // Send appropriate email
  if (cancellationReason === 'user_requested') {
    await sendCancellationConfirmationEmail(oneSubUserId, effective);
  } else if (cancellationReason === 'payment_failed') {
    await sendPaymentFailedEmail(oneSubUserId);
  }
  
  // Clear subscription cache
  subscriptionCache.delete(oneSubUserId);
  
  // Log for analytics
  await trackCancellation(oneSubUserId, planId, cancellationReason);
  break;
```

---

---

## purchase.completed

Sent when a user completes a one-time purchase of your tool or credit package.

### When Sent

- User completes a one-time tool purchase
- User buys credits for your tool
- Payment is confirmed for non-subscription purchases

### Payload

<ResponseField name="id" type="string" required>
Unique event ID
</ResponseField>

<ResponseField name="type" type="string" required>
Always `"purchase.completed"`
</ResponseField>

<ResponseField name="created" type="number" required>
Unix timestamp
</ResponseField>

<ResponseField name="data" type="object" required>
Event data

<Expandable title="Data Fields">
  <ResponseField name="oneSubUserId" type="string (UUID)" required>
  The 1Sub user ID
  </ResponseField>
  
  <ResponseField name="checkoutId" type="string (UUID)" required>
  Checkout session ID for this purchase
  </ResponseField>
  
  <ResponseField name="amount" type="number" required>
  Purchase amount (in credits or currency units)
  </ResponseField>
  
  <ResponseField name="creditsRemaining" type="number">
  User's remaining credit balance after purchase
  </ResponseField>
  
  <ResponseField name="purchaseType" type="string">
  Type of purchase: `"tool_access"`, `"credits"`, `"one_time"`
  </ResponseField>
</Expandable>
</ResponseField>

### Example Payload

```json
{
  "id": "evt_purchase_001",
  "type": "purchase.completed",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "550e8400-e29b-41d4-a716-446655440000",
    "checkoutId": "chk_abc123def456",
    "amount": 100,
    "creditsRemaining": 150,
    "purchaseType": "credits"
  }
}
```

### How to Handle

```typescript
case 'purchase.completed':
  const { oneSubUserId, checkoutId, amount, purchaseType } = event.data;
  
  // Log purchase
  await logPurchase(oneSubUserId, checkoutId, amount, purchaseType);
  
  // Grant one-time access if applicable
  if (purchaseType === 'tool_access') {
    await grantToolAccess(oneSubUserId);
  }
  
  // Send purchase confirmation email
  await sendPurchaseConfirmation(oneSubUserId, amount);
  
  break;
```

---

## user.credit_low

Sent when a user's credit balance falls below the low credit threshold.

### When Sent

- User's credit balance drops to 10 or fewer credits
- Triggered during credit consumption
- Only sent once when crossing the threshold (not on every transaction)

### Payload

<ResponseField name="id" type="string" required>
Unique event ID
</ResponseField>

<ResponseField name="type" type="string" required>
Always `"user.credit_low"`
</ResponseField>

<ResponseField name="created" type="number" required>
Unix timestamp
</ResponseField>

<ResponseField name="data" type="object" required>
Event data

<Expandable title="Data Fields">
  <ResponseField name="oneSubUserId" type="string (UUID)" required>
  The 1Sub user ID
  </ResponseField>
  
  <ResponseField name="creditBalance" type="number" required>
  User's current credit balance
  </ResponseField>
  
  <ResponseField name="threshold" type="number" required>
  The low credit threshold that was crossed (typically 10)
  </ResponseField>
</Expandable>
</ResponseField>

### Example Payload

```json
{
  "id": "evt_credit_low_001",
  "type": "user.credit_low",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "550e8400-e29b-41d4-a716-446655440000",
    "creditBalance": 8,
    "threshold": 10
  }
}
```

### How to Handle

```typescript
case 'user.credit_low':
  const { oneSubUserId, creditBalance, threshold } = event.data;
  
  // Send low credit warning email
  await sendLowCreditWarning(oneSubUserId, creditBalance);
  
  // Show in-app notification on next login
  await queueNotification(oneSubUserId, {
    type: 'credit_low',
    message: `Your credit balance is low (${creditBalance} remaining). Purchase more credits to continue using ${toolName}.`,
  });
  
  // Log for analytics
  await trackEvent('credit_low_warning', { userId: oneSubUserId, balance: creditBalance });
  
  break;
```

---

## user.credit_depleted

Sent when a user's credit balance reaches zero.

### When Sent

- User's credit balance hits exactly 0
- Triggered during credit consumption
- Indicates user can no longer use credit-based features

### Payload

<ResponseField name="id" type="string" required>
Unique event ID
</ResponseField>

<ResponseField name="type" type="string" required>
Always `"user.credit_depleted"`
</ResponseField>

<ResponseField name="created" type="number" required>
Unix timestamp
</ResponseField>

<ResponseField name="data" type="object" required>
Event data

<Expandable title="Data Fields">
  <ResponseField name="oneSubUserId" type="string (UUID)" required>
  The 1Sub user ID
  </ResponseField>
  
  <ResponseField name="creditBalance" type="number" required>
  Always 0
  </ResponseField>
</Expandable>
</ResponseField>

### Example Payload

```json
{
  "id": "evt_credit_depleted_001",
  "type": "user.credit_depleted",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "550e8400-e29b-41d4-a716-446655440000",
    "creditBalance": 0
  }
}
```

### How to Handle

```typescript
case 'user.credit_depleted':
  const { oneSubUserId } = event.data;
  
  // Suspend credit-based features
  await suspendCreditFeatures(oneSubUserId);
  
  // Send urgent notification
  await sendCreditDepletedEmail(oneSubUserId);
  
  // Show paywall on next request
  await setUserFlag(oneSubUserId, 'show_credit_paywall', true);
  
  // Log for analytics
  await trackEvent('credits_depleted', { userId: oneSubUserId });
  
  break;
```

---

## tool.status_changed

Sent when your tool's status changes on the 1Sub platform (activated, suspended, etc.).

### When Sent

- Tool is activated by 1Sub admin
- Tool is suspended or deactivated
- Tool undergoes maintenance mode changes

<Warning>
This is a system-level event. The `oneSubUserId` field will be `"system"` instead of an actual user ID.
</Warning>

### Payload

<ResponseField name="id" type="string" required>
Unique event ID
</ResponseField>

<ResponseField name="type" type="string" required>
Always `"tool.status_changed"`
</ResponseField>

<ResponseField name="created" type="number" required>
Unix timestamp
</ResponseField>

<ResponseField name="data" type="object" required>
Event data

<Expandable title="Data Fields">
  <ResponseField name="oneSubUserId" type="string" required>
  Always `"system"` (this is a system event, not user-specific)
  </ResponseField>
  
  <ResponseField name="toolId" type="string (UUID)" required>
  Your tool's ID
  </ResponseField>
  
  <ResponseField name="toolStatus" type="boolean" required>
  `true` if tool is active, `false` if suspended/inactive
  </ResponseField>
</Expandable>
</ResponseField>

### Example Payload

```json
{
  "id": "evt_tool_status_001",
  "type": "tool.status_changed",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "system",
    "toolId": "660e8400-e29b-41d4-a716-446655440000",
    "toolStatus": false
  }
}
```

### How to Handle

```typescript
case 'tool.status_changed':
  const { toolId, toolStatus } = event.data;
  
  if (!toolStatus) {
    // Tool suspended - enter maintenance mode
    await enableMaintenanceMode();
    
    // Notify all active users
    await notifyAllUsers({
      type: 'maintenance',
      message: 'Service temporarily unavailable. We\'ll be back shortly.',
    });
    
    // Alert ops team
    await alertOps(`Tool ${toolId} suspended on 1Sub`);
  } else {
    // Tool reactivated
    await disableMaintenanceMode();
    await notifyAllUsers({
      type: 'info',
      message: 'Service is back online!',
    });
  }
  
  break;
```

---

## Event Deduplication

Always deduplicate events using the event `id` to handle retries:

```typescript
// In-memory deduplication (use Redis/DB in production)
const processedEvents = new Set<string>();

function handleWebhook(event: WebhookEvent) {
  // Check if already processed
  if (processedEvents.has(event.id)) {
    console.log(`Event ${event.id} already processed, skipping`);
    return;
  }
  
  // Mark as processed
  processedEvents.add(event.id);
  
  // Process event
  switch (event.type) {
    case 'subscription.activated':
      // ...
      break;
    case 'purchase.completed':
      // ...
      break;
    case 'user.credit_low':
      // ...
      break;
    case 'user.credit_depleted':
      // ...
      break;
    case 'tool.status_changed':
      // ...
      break;
    // ...
  }
}
```

## Event Ordering

Events may arrive out of order. Use the `created` timestamp to determine the correct sequence:

```typescript
// Store events
const events = [];
events.push(event);

// Sort by created timestamp before processing
events.sort((a, b) => a.created - b.created);

// Process in order
for (const event of events) {
  handleWebhook(event);
}
```

<Tip>
For critical operations, verify the current state via the API rather than relying solely on webhook order.
</Tip>

