---
title: "Webhooks"
description: "Get notified immediately when subscriptions change"
---

# Webhooks

Webhooks notify you instantly when something changes - like a user canceling their subscription. This lets you revoke access immediately instead of waiting for the next access check.

---

## Setup

1. Add a webhook endpoint to your app
2. Enter the URL in your [vendor dashboard](https://1sub.io/vendor/dashboard)
3. Save the webhook secret we provide

---

## Handle Events

<Steps>
<Step title="Configure webhook URL">
  Set your webhook endpoint in the 1Sub vendor dashboard:
  
```
https://yourtool.com/webhooks/1sub
```
</Step>

<Step title="Event occurs">
  User subscribes, cancels, or updates their subscription on 1Sub.
</Step>

<Step title="1Sub sends HTTP POST">
  We send a POST request to your webhook URL with event details:
  
```json
{
  "id": "evt_abc123",
  "type": "subscription.activated",
  "created": 1700000000,
  "data": {
    "oneSubUserId": "uuid-abc-123",
    "userEmail": "user@example.com",
    "planId": "monthly",
    "status": "active"
  }
}
```
</Step>

<Step title="You verify and process">
  Your endpoint verifies the signature and processes the event:
  
```typescript
// Verify signature
if (!verifySignature(payload, signature)) {
  return res.status(401).send('Invalid signature');
}

// Process event
const event = JSON.parse(payload);
handleSubscriptionEvent(event);

// Acknowledge receipt
res.json({ received: true });
```
</Step>

<Step title="Return 2xx response">
  Return any 2xx status code to acknowledge receipt. We'll retry if you don't.
</Step>
</Steps>

## Webhook Events

1Sub sends webhooks for subscription lifecycle, purchases, credit status, entitlements, credit consumption, and system events:

### Subscription Lifecycle Events

<AccordionGroup>
<Accordion title="subscription.activated">
Sent when a new subscription is created or reactivated.

**When it's sent:**
- User completes initial subscription
- User reactivates a canceled subscription
- Free trial begins

**Use cases:**
- Grant user access
- Send welcome email
- Set up user resources
- Clear subscription cache

```json
{
  "type": "subscription.activated",
  "data": {
    "oneSubUserId": "uuid-abc-123",
    "userEmail": "user@example.com",
    "planId": "pro",
    "status": "trialing",
    "currentPeriodEnd": "2025-12-01T00:00:00Z",
    "trialEndsAt": "2025-11-08T00:00:00Z"
  }
}
```
</Accordion>

<Accordion title="subscription.updated">
Sent when subscription details change.

**When it's sent:**
- User upgrades/downgrades plan
- Billing period renews
- Payment method updated
- Trial ends and converts to paid

**Use cases:**
- Update user's plan features
- Adjust usage limits
- Clear subscription cache
- Log plan changes

```json
{
  "type": "subscription.updated",
  "data": {
    "oneSubUserId": "uuid-abc-123",
    "userEmail": "user@example.com",
    "planId": "enterprise",
    "status": "active",
    "previousPlanId": "pro",
    "currentPeriodEnd": "2025-12-01T00:00:00Z"
  }
}
```
</Accordion>

<Accordion title="subscription.canceled">
Sent when a subscription is canceled.

**When it's sent:**
- User cancels subscription
- Payment fails after retry period
- Subscription expires

**Use cases:**
- Revoke user access
- Send cancellation survey
- Archive user data
- Clear subscription cache

```json
{
  "type": "subscription.canceled",
  "data": {
    "oneSubUserId": "uuid-abc-123",
    "userEmail": "user@example.com",
    "planId": "pro",
    "status": "canceled",
    "cancellationReason": "user_requested",
    "effectiveDate": "2025-12-01T00:00:00Z"
  }
}
```
</Accordion>
</AccordionGroup>

### Purchase Events

<AccordionGroup>
<Accordion title="purchase.completed">
Sent when a user completes a one-time purchase.

**When it's sent:**
- User completes one-time tool purchase
- User buys credit package
- Non-subscription payment confirmed

**Use cases:**
- Grant one-time access
- Log purchase for analytics
- Send purchase confirmation
- Update credit balance display

```json
{
  "type": "purchase.completed",
  "data": {
    "oneSubUserId": "uuid-abc-123",
    "userEmail": "user@example.com",
    "checkoutId": "chk_abc123",
    "amount": 100,
    "purchaseType": "credits"
  }
}
```
</Accordion>
</AccordionGroup>

### Credit Notification Events

<AccordionGroup>
<Accordion title="user.credit_low">
Sent when a user's credits fall below the threshold (10 credits).

**When it's sent:**
- User's balance drops to 10 or fewer credits
- Only sent once when crossing threshold

**Use cases:**
- Send low credit warning
- Show in-app notification
- Prompt credit purchase
- Track credit usage patterns

```json
{
  "type": "user.credit_low",
  "data": {
    "oneSubUserId": "uuid-abc-123",
    "userEmail": "user@example.com",
    "creditBalance": 8,
    "threshold": 10
  }
}
```
</Accordion>

<Accordion title="user.credit_depleted">
Sent when a user's credit balance reaches zero.

**When it's sent:**
- User's balance hits exactly 0
- User can no longer use credit-based features

**Use cases:**
- Suspend credit features
- Send urgent notification
- Show credit paywall
- Log credit depletion

```json
{
  "type": "user.credit_depleted",
  "data": {
    "oneSubUserId": "uuid-abc-123",
    "userEmail": "user@example.com",
    "creditBalance": 0
  }
}
```
</Accordion>
</AccordionGroup>

### Entitlement Events

<AccordionGroup>
<Accordion title="entitlement.granted">
Sent when a user is granted access via authorization code exchange.

**When it's sent:**
- User completes OAuth-style authorization flow
- Authorization code is exchanged for access
- User's entitlement is activated

**Use cases:**
- Create or activate user account
- Grant tool access
- Send welcome email
- Log entitlement grant

```json
{
  "type": "entitlement.granted",
  "data": {
    "oneSubUserId": "uuid-abc-123",
    "userEmail": "user@example.com",
    "grantId": "grant_abc123",
    "planId": "pro",
    "status": "active",
    "creditsRemaining": 1000
  }
}
```
</Accordion>

<Accordion title="entitlement.revoked">
Sent when a user's access is revoked.

**When it's sent:**
- Subscription expires or is canceled
- User manually revokes access
- Admin revokes access (fraud, TOS violation)
- Payment failure after grace period

**Use cases:**
- Immediately revoke user access
- Clear cached user data
- Send appropriate notification
- Log revocation event

```json
{
  "type": "entitlement.revoked",
  "data": {
    "oneSubUserId": "uuid-abc-123",
    "userEmail": "user@example.com",
    "reason": "subscription_ended",
    "revokedAt": "2025-12-01T00:00:00Z",
    "status": "canceled"
  }
}
```
</Accordion>

<Accordion title="entitlement.changed">
Sent when a user's entitlement changes (plan upgrade/downgrade, feature modifications).

**When it's sent:**
- User upgrades or downgrades their plan
- Plan features are modified
- Access level changes

**Use cases:**
- Update user's access level
- Enable/disable features
- Send plan change notification
- Clear entitlement cache

```json
{
  "type": "entitlement.changed",
  "data": {
    "oneSubUserId": "uuid-abc-123",
    "userEmail": "user@example.com",
    "previousState": {
      "planId": "basic",
      "features": ["feature_a", "feature_b"]
    },
    "newState": {
      "planId": "pro",
      "features": ["feature_a", "feature_b", "feature_c", "feature_d"]
    },
    "planId": "pro",
    "creditsRemaining": 2000
  }
}
```
</Accordion>

<Accordion title="verify.required">
Sent when immediate verification is required due to a security event.

**When it's sent:**
- Fraud detection triggers
- Admin manually flags account
- Suspicious activity detected
- Policy violations

**Use cases:**
- Invalidate all cached entitlements
- Flag user for fresh verification
- Optionally suspend access
- Alert security team

```json
{
  "type": "verify.required",
  "data": {
    "oneSubUserId": "uuid-abc-123",
    "userEmail": "user@example.com",
    "reason": "suspicious_activity"
  }
}
```

<Warning>
When you receive this event, you MUST verify the user's current entitlements via the `/api/v1/verify` endpoint before allowing further access.
</Warning>
</Accordion>
</AccordionGroup>

### Credit Consumption Events

<AccordionGroup>
<Accordion title="credits.consumed">
Sent when a user consumes credits for your tool.

**When it's sent:**
- User makes API call that consumes credits
- Tool uses `/api/v1/credits/consume` endpoint
- Credits successfully deducted from balance

**Use cases:**
- Log credit usage for analytics
- Send low balance warnings
- Update usage metrics
- Track for billing/reporting

```json
{
  "event": "credits.consumed",
  "timestamp": "2025-12-22T10:30:00.000Z",
  "data": {
    "user_id": "uuid-abc-123",
    "amount": 10,
    "balance_remaining": 90,
    "transaction_id": "txn_abc123"
  }
}
```

<Note>
This event uses a different payload structure: `event` instead of `type`, and `timestamp` (ISO 8601) instead of `created` (Unix timestamp).
</Note>
</Accordion>
</AccordionGroup>

### System Events

<AccordionGroup>
<Accordion title="tool.status_changed">
Sent when your tool's status changes (system event).

**When it's sent:**
- Tool activated by admin
- Tool suspended/deactivated
- Maintenance mode changes

**Use cases:**
- Enter/exit maintenance mode
- Notify active users
- Alert operations team

```json
{
  "type": "tool.status_changed",
  "data": {
    "oneSubUserId": "system",
    "toolId": "tool-uuid",
    "toolStatus": false
  }
}
```
</Accordion>
</AccordionGroup>

## Webhook Payload Structure

All webhooks follow this structure:

<ResponseField name="id" type="string" required>
Unique event identifier (format: `evt_xxxxx`)
</ResponseField>

<ResponseField name="type" type="string" required>
Event type: `subscription.activated`, `subscription.updated`, `subscription.canceled`, `purchase.completed`, `user.credit_low`, `user.credit_depleted`, `tool.status_changed`, `entitlement.granted`, `entitlement.revoked`, `entitlement.changed`, `verify.required`, or `credits.consumed` (note: `credits.consumed` uses `event` field instead)
</ResponseField>

<ResponseField name="created" type="number" required>
Unix timestamp when the event was created
</ResponseField>

<ResponseField name="data" type="object" required>
Event-specific data about the subscription change

<Expandable title="Common Data Fields">
  <ResponseField name="oneSubUserId" type="string (UUID)" required>
  The 1Sub user ID
  </ResponseField>
  
  <ResponseField name="userEmail" type="string">
  The user's email address
  </ResponseField>
  
  <ResponseField name="planId" type="string" required>
  Plan identifier
  </ResponseField>
  
  <ResponseField name="status" type="string" required>
  Current subscription status
  </ResponseField>
  
  <ResponseField name="currentPeriodEnd" type="string (ISO 8601)">
  End of current billing period
  </ResponseField>
</Expandable>
</ResponseField>

## Security

Webhooks include an HMAC signature in the `x-1sub-signature` header to prove authenticity.

```http
x-1sub-signature: t=1700000000,v1=abcdef123456789...
```

**Always verify signatures before processing webhooks!**

<Warning>
Never process webhooks without signature verification. This prevents attackers from sending fake events.
</Warning>

See [Security and Signing](/webhooks/security-and-signing) for implementation details.

## Delivery Guarantees

<AccordionGroup>
<Accordion title="At-least-once delivery">
We guarantee each event will be delivered **at least once**. In rare cases (network issues, retries), you may receive duplicate events.

**Mitigation:** Use the event `id` to deduplicate:

<Card title="Event Reference" icon="list" href="/docs/webhooks/events">
  Full list of events and payload formats
</Card>
</Accordion>
</AccordionGroup>
